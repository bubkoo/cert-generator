{"version":3,"sources":["webpack:///index.js","webpack:///webpack/bootstrap ed0a378d643c12c11281","webpack:///./src/index.js","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///external \"async\"","webpack:///external \"rimraf\"","webpack:///external \"mkdirp\"","webpack:///external \"user-home\"","webpack:///./src/genetator.js","webpack:///external \"node-forge\""],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","certExists","_len","arguments","length","files","Array","_key","Promise","resolve","reject","_async2","every","file","next","_fs2","access","error","result","createCerts","_len2","_key2","arr","map","writeFile","path","content","encoding","parallel","readCerts","certFile","keyFile","readFile","results","cert","key","Object","defineProperty","value","_extends","assign","target","i","source","prototype","hasOwnProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","_fs","_path","_path2","_async","_rimraf","_rimraf2","_mkdirp","_mkdirp2","_userHome","_userHome2","_genetator","DEFAULTS","dir","join","name","Generator","options","undefined","this","cache","rootKey","rootCert","rootKeyPath","rootCertPath","_this","waterfall","clearCerts","then","_generateRootCA2","generateRootCA","privateKey","certificate","hostname","_this2","cached","ret","exist","generateCertForHostname","_this3","isRootCAExists","exists","require","_toConsumableArray","isArray","arr2","from","toNameValue","keys","getKeysAndCert","serialNumber","Math","floor","random","_nodeForge2","pki","rsa","generateKeyPair","createCertificate","publicKey","String","validity","notBefore","Date","notAfter","setFullYear","getFullYear","_getKeysAndCert","subject","METADATA","issuer","extensions","EXTENSIONS","setSubject","setIssuer","setExtensions","sign","md","sha256","create","privateKeyToPem","publicKeyToPem","certificateToPem","domain","rootCAConfig","md5","update","_getKeysAndCert2","digest","toHex","caCert","certificateFromPem","caKey","privateKeyFromPem","commonName","attributes","_nodeForge","countryName","stateOrProvinceName","localityName","organizationName","organizationalUnitName","emailAddress","cA"],"mappings":"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","file":"index.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _fs = __webpack_require__(1);\n\t\n\tvar _fs2 = _interopRequireDefault(_fs);\n\t\n\tvar _path = __webpack_require__(2);\n\t\n\tvar _path2 = _interopRequireDefault(_path);\n\t\n\tvar _async = __webpack_require__(3);\n\t\n\tvar _async2 = _interopRequireDefault(_async);\n\t\n\tvar _rimraf = __webpack_require__(4);\n\t\n\tvar _rimraf2 = _interopRequireDefault(_rimraf);\n\t\n\tvar _mkdirp = __webpack_require__(5);\n\t\n\tvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\t\n\tvar _userHome = __webpack_require__(6);\n\t\n\tvar _userHome2 = _interopRequireDefault(_userHome);\n\t\n\tvar _genetator = __webpack_require__(7);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t  dir: _path2.default.join(_userHome2.default, '.cert'),\n\t  name: 'root'\n\t};\n\t\n\tfunction certExists() {\n\t  for (var _len = arguments.length, files = Array(_len), _key = 0; _key < _len; _key++) {\n\t    files[_key] = arguments[_key];\n\t  }\n\t\n\t  return new Promise(function (resolve, reject) {\n\t\n\t    _async2.default.every(files, function (file, next) {\n\t\n\t      _fs2.default.access(file, function (error) {\n\t        next(null, !error);\n\t      });\n\t    }, function (error, result) {\n\t      if (error) {\n\t        reject(error);\n\t      } else {\n\t        // if result is true then every file exists\n\t        resolve(result);\n\t      }\n\t    });\n\t  });\n\t}\n\t\n\tfunction createCerts() {\n\t  for (var _len2 = arguments.length, files = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t    files[_key2] = arguments[_key2];\n\t  }\n\t\n\t  return new Promise(function (resolve, reject) {\n\t\n\t    var arr = files.map(function (file) {\n\t      return function (next) {\n\t        _fs2.default.writeFile(file.path, file.content, { encoding: 'utf-8' }, function (error) {\n\t          next(null, !error);\n\t        });\n\t      };\n\t    });\n\t\n\t    _async2.default.parallel(arr, function (error) {\n\t      if (error) {\n\t        reject(error);\n\t      } else {\n\t        resolve();\n\t      }\n\t    });\n\t  });\n\t}\n\t\n\tfunction readCerts(certFile, keyFile) {\n\t  return new Promise(function (resolve, reject) {\n\t\n\t    var arr = [certFile, keyFile].map(function (file) {\n\t      return function (next) {\n\t        return _fs2.default.readFile(file, { encoding: 'utf-8' }, next);\n\t      };\n\t    });\n\t\n\t    _async2.default.parallel(arr, function (error, results) {\n\t      if (error) {\n\t        reject(error);\n\t      } else {\n\t        resolve({\n\t          cert: results[0],\n\t          key: results[1]\n\t        });\n\t      }\n\t    });\n\t  });\n\t}\n\t\n\tvar Generator = function () {\n\t  function Generator() {\n\t    var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t    _classCallCheck(this, Generator);\n\t\n\t    this.options = _extends({}, DEFAULTS, options);\n\t\n\t    this.dir = _path2.default.resolve(this.options.dir);\n\t    this.cache = {};\n\t\n\t    this.rootKey = null;\n\t    this.rootCert = null;\n\t\n\t    this.rootKeyPath = _path2.default.join(this.dir, this.options.name + '.key');\n\t    this.rootCertPath = _path2.default.join(this.dir, this.options.name + '.crt');\n\t  }\n\t\n\t  _createClass(Generator, [{\n\t    key: 'generateRootCA',\n\t    value: function generateRootCA() {\n\t      var _this = this;\n\t\n\t      return new Promise(function (resolve, reject) {\n\t\n\t        _async2.default.waterfall([function (next) {\n\t          _this.clearCerts().then(next, next);\n\t        }, function (next) {\n\t          (0, _mkdirp2.default)(_this.dir, function (error) {\n\t            if (error) {\n\t              next(error);\n\t            } else {\n\t              next();\n\t            }\n\t          });\n\t        }, function (next) {\n\t          var _generateRootCA2 = (0, _genetator.generateRootCA)();\n\t\n\t          var privateKey = _generateRootCA2.privateKey;\n\t          var certificate = _generateRootCA2.certificate;\n\t\n\t\n\t          createCerts({\n\t            path: _this.rootCertPath,\n\t            content: certificate\n\t          }, {\n\t            path: _this.rootKeyPath,\n\t            content: privateKey\n\t          }).then({\n\t            cert: certificate,\n\t            key: privateKey\n\t          }, next).catch(next);\n\t        }], function (error, result) {\n\t          if (error) {\n\t            reject(error);\n\t          } else {\n\t            resolve(result);\n\t          }\n\t        });\n\t      });\n\t    }\n\t  }, {\n\t    key: 'getCertificate',\n\t    value: function getCertificate(hostname) {\n\t      var _this2 = this;\n\t\n\t      return new Promise(function (resolve, reject) {\n\t\n\t        var cached = _this2.cache[hostname] || {};\n\t\n\t        if (cached.cert && cached.key) {\n\t          resolve(cached);\n\t        } else {\n\t          (function () {\n\t\n\t            var keyFile = _path2.default.join(_this2.dir, hostname + '.key');\n\t            var certFile = _path2.default.join(_this2.dir, hostname + '.crt');\n\t\n\t            _async2.default.waterfall([\n\t\n\t            // check root cert cache\n\t            function (next) {\n\t              if (!_this2.rootCert || !_this2.rootKey) {\n\t                readCerts(_this2.rootCertPath, _this2.rootKeyPath).then(function (ret) {\n\t                  _this2.rootKey = ret.key;\n\t                  _this2.rootCert = ret.cert;\n\t                  next(null);\n\t                }).catch(next);\n\t              } else {\n\t                next(null);\n\t              }\n\t            },\n\t\n\t            // create\n\t            function (next) {\n\t\n\t              certExists(certFile, keyFile).then(function (exist) {\n\t                if (!exist) {\n\t                  var ret = (0, _genetator.generateCertForHostname)(hostname, {\n\t                    key: _this2.rootKey,\n\t                    cert: _this2.rootCert\n\t                  });\n\t\n\t                  createCerts({\n\t                    path: certFile,\n\t                    content: ret.certificate\n\t                  }, {\n\t                    path: keyFile,\n\t                    content: ret.privateKey\n\t                  }).then(next, next);\n\t                } else {\n\t                  next();\n\t                }\n\t              });\n\t            },\n\t\n\t            // read\n\t            function (next) {\n\t\n\t              readCerts(certFile, keyFile).then(function (ret) {\n\t                _this2.cache[hostname] = ret;\n\t                next(null, ret);\n\t              }).catch(next);\n\t            }], function (error, result) {\n\t              if (error) {\n\t                reject(error);\n\t              } else {\n\t                resolve(result);\n\t              }\n\t            });\n\t          })();\n\t        }\n\t      });\n\t    }\n\t  }, {\n\t    key: 'isRootCAExists',\n\t    value: function isRootCAExists() {\n\t      return certExists(this.rootCertPath, this.rootKeyPath);\n\t    }\n\t  }, {\n\t    key: 'clearCerts',\n\t    value: function clearCerts() {\n\t      var _this3 = this;\n\t\n\t      return new Promise(function (resolve, reject) {\n\t        _this3.isRootCAExists().then(function (exists) {\n\t          if (exists) {\n\t            (0, _rimraf2.default)(_this3.dir, function (error) {\n\t              if (error) {\n\t                reject(error);\n\t              } else {\n\t                resolve();\n\t              }\n\t            });\n\t          } else {\n\t            resolve();\n\t          }\n\t        });\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return Generator;\n\t}();\n\t\n\texports.default = Generator;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"fs\");\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"path\");\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"async\");\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"rimraf\");\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"mkdirp\");\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"user-home\");\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.generateCertForHostname = exports.generateRootCA = undefined;\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _nodeForge = __webpack_require__(8);\n\t\n\tvar _nodeForge2 = _interopRequireDefault(_nodeForge);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar METADATA = {\n\t  commonName: 'Sample Service',\n\t  countryName: 'US',\n\t  stateOrProvinceName: 'Wisconsin',\n\t  localityName: 'Madison',\n\t  organizationName: 'University of Wisconsin -- Madison',\n\t  organizationalUnitName: 'Computer Sciences Department',\n\t  emailAddress: 'email@sample.com'\n\t};\n\t\n\tvar EXTENSIONS = [{\n\t  name: 'basicConstraints',\n\t  cA: true\n\t}];\n\t\n\tfunction toNameValue() {\n\t  var obj = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t  return Object.keys(obj).map(function (key) {\n\t    return {\n\t      name: key,\n\t      value: obj[key]\n\t    };\n\t  });\n\t}\n\t\n\tfunction getKeysAndCert() {\n\t  var serialNumber = arguments.length <= 0 || arguments[0] === undefined ? Math.floor(Math.random() * 100000) : arguments[0];\n\t\n\t\n\t  var keys = _nodeForge2.default.pki.rsa.generateKeyPair(2048);\n\t  var cert = _nodeForge2.default.pki.createCertificate();\n\t\n\t  cert.publicKey = keys.publicKey;\n\t  cert.serialNumber = String(serialNumber);\n\t\n\t  cert.validity.notBefore = new Date();\n\t  cert.validity.notAfter = new Date();\n\t  cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 10);\n\t\n\t  return {\n\t    keys: keys,\n\t    cert: cert\n\t  };\n\t}\n\t\n\tfunction generateRootCA() {\n\t  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t  var _getKeysAndCert = getKeysAndCert();\n\t\n\t  var keys = _getKeysAndCert.keys;\n\t  var cert = _getKeysAndCert.cert;\n\t\n\t\n\t  var subject = toNameValue(_extends({}, METADATA, options.subject));\n\t  var issuer = toNameValue(_extends({}, METADATA, options.issuer));\n\t  var extensions = [].concat(EXTENSIONS, _toConsumableArray(options.extensions || []));\n\t\n\t  cert.setSubject(subject);\n\t  cert.setIssuer(issuer);\n\t  cert.setExtensions(extensions);\n\t\n\t  cert.sign(keys.privateKey, _nodeForge2.default.md.sha256.create());\n\t\n\t  return {\n\t    privateKey: _nodeForge2.default.pki.privateKeyToPem(keys.privateKey),\n\t    publicKey: _nodeForge2.default.pki.publicKeyToPem(keys.publicKey),\n\t    certificate: _nodeForge2.default.pki.certificateToPem(cert)\n\t  };\n\t}\n\t\n\tfunction generateCertForHostname(domain, rootCAConfig) {\n\t\n\t  // generate a serialNumber for domain\n\t  var md = _nodeForge2.default.md.md5.create();\n\t\n\t  md.update(domain);\n\t\n\t  var _getKeysAndCert2 = getKeysAndCert(md.digest().toHex());\n\t\n\t  var keys = _getKeysAndCert2.keys;\n\t  var cert = _getKeysAndCert2.cert;\n\t\n\t\n\t  var caCert = _nodeForge2.default.pki.certificateFromPem(rootCAConfig.cert);\n\t  var caKey = _nodeForge2.default.pki.privateKeyFromPem(rootCAConfig.key);\n\t\n\t  var subject = toNameValue(_extends({}, METADATA, { commonName: domain }));\n\t\n\t  cert.setIssuer(caCert.subject.attributes); // issuer from CA\n\t  cert.setSubject(subject);\n\t\n\t  cert.sign(caKey, _nodeForge2.default.md.sha256.create());\n\t\n\t  return {\n\t    privateKey: _nodeForge2.default.pki.privateKeyToPem(keys.privateKey),\n\t    publicKey: _nodeForge2.default.pki.publicKeyToPem(keys.publicKey),\n\t    certificate: _nodeForge2.default.pki.certificateToPem(cert)\n\t  };\n\t}\n\t\n\texports.generateRootCA = generateRootCA;\n\texports.generateCertForHostname = generateCertForHostname;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"node-forge\");\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** index.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ed0a378d643c12c11281\n **/","import fs       from 'fs';\nimport path     from 'path';\nimport async    from 'async';\nimport rimraf   from 'rimraf';\nimport mkdirp   from 'mkdirp';\nimport userHome from 'user-home';\nimport {\n  generateRootCA,\n  generateCertForHostname\n} from './genetator';\n\nconst DEFAULTS = {\n  dir: path.join(userHome, '.cert'),\n  name: 'root'\n};\n\nfunction certExists(...files) {\n  return new Promise((resolve, reject) => {\n\n    async.every(files, (file, next) => {\n\n      fs.access(file, error => {\n        next(null, !error);\n      });\n\n    }, (error, result) => {\n      if (error) {\n        reject(error);\n      } else {\n        // if result is true then every file exists\n        resolve(result);\n      }\n    });\n  });\n}\n\nfunction createCerts(...files) {\n  return new Promise((resolve, reject) => {\n\n    const arr = files.map(file => next => {\n      fs.writeFile(file.path, file.content, { encoding: 'utf-8' }, error => {\n        next(null, !error);\n      });\n    });\n\n    async.parallel(arr, error => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\nfunction readCerts(certFile, keyFile) {\n  return new Promise((resolve, reject) => {\n\n    const arr = [\n      certFile,\n      keyFile\n    ].map(file => next => fs.readFile(file, { encoding: 'utf-8' }, next));\n\n    async.parallel(arr, (error, results) => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve({\n          cert: results[0],\n          key: results[1]\n        });\n      }\n    });\n  });\n}\n\n\nclass Generator {\n\n  constructor(options = {}) {\n\n    this.options = { ...DEFAULTS, ...options };\n\n    this.dir   = path.resolve(this.options.dir);\n    this.cache = {};\n\n    this.rootKey  = null;\n    this.rootCert = null;\n\n    this.rootKeyPath  = path.join(this.dir, `${this.options.name}.key`);\n    this.rootCertPath = path.join(this.dir, `${this.options.name}.crt`);\n  }\n\n  generateRootCA() {\n\n    return new Promise((resolve, reject) => {\n\n      async.waterfall([\n\n        next => {\n          this.clearCerts().then(next, next);\n        },\n\n        next => {\n          mkdirp(this.dir, error => {\n            if (error) {\n              next(error);\n            } else {\n              next();\n            }\n          });\n        },\n\n        next => {\n\n          let { privateKey, certificate } = generateRootCA();\n\n          createCerts({\n            path: this.rootCertPath,\n            content: certificate\n          }, {\n            path: this.rootKeyPath,\n            content: privateKey\n          })\n            .then({\n              cert: certificate,\n              key: privateKey\n            }, next)\n            .catch(next);\n        }\n      ], (error, result) => {\n        if (error) {\n          reject(error);\n        } else {\n          resolve(result);\n        }\n      });\n    });\n  }\n\n  getCertificate(hostname) {\n\n    return new Promise((resolve, reject) => {\n\n      const cached = this.cache[hostname] || {};\n\n      if (cached.cert && cached.key) {\n        resolve(cached);\n      } else {\n\n        let keyFile  = path.join(this.dir, `${hostname}.key`);\n        let certFile = path.join(this.dir, `${hostname}.crt`);\n\n        async.waterfall([\n\n          // check root cert cache\n          next => {\n            if (!this.rootCert || !this.rootKey) {\n              readCerts(this.rootCertPath, this.rootKeyPath)\n                .then(ret => {\n                  this.rootKey  = ret.key;\n                  this.rootCert = ret.cert;\n                  next(null);\n                })\n                .catch(next);\n            } else {\n              next(null);\n            }\n          },\n\n          // create\n          next => {\n\n            certExists(certFile, keyFile)\n              .then(exist => {\n                if (!exist) {\n                  let ret = generateCertForHostname(hostname, {\n                    key: this.rootKey,\n                    cert: this.rootCert\n                  });\n\n                  createCerts({\n                    path: certFile,\n                    content: ret.certificate\n                  }, {\n                    path: keyFile,\n                    content: ret.privateKey\n                  }).then(next, next);\n                } else {\n                  next();\n                }\n              });\n          },\n\n          // read\n          next => {\n\n            readCerts(certFile, keyFile)\n              .then(ret => {\n                this.cache[hostname] = ret;\n                next(null, ret);\n              })\n              .catch(next);\n          }\n        ], (error, result) => {\n          if (error) {\n            reject(error);\n          } else {\n            resolve(result);\n          }\n        });\n      }\n    });\n  }\n\n  isRootCAExists() {\n    return certExists(this.rootCertPath, this.rootKeyPath);\n  }\n\n  clearCerts() {\n    return new Promise((resolve, reject) => {\n      this.isRootCAExists()\n        .then(exists => {\n          if (exists) {\n            rimraf(this.dir, (error) => {\n              if (error) {\n                reject(error);\n              } else {\n                resolve();\n              }\n            });\n          } else {\n            resolve();\n          }\n        });\n    });\n  }\n}\n\n\nexport default Generator;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"async\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"async\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"rimraf\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"rimraf\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"mkdirp\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mkdirp\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"user-home\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"user-home\"\n ** module id = 6\n ** module chunks = 0\n **/","import forge from 'node-forge';\n\nconst METADATA = {\n  commonName: 'Sample Service',\n  countryName: 'US',\n  stateOrProvinceName: 'Wisconsin',\n  localityName: 'Madison',\n  organizationName: 'University of Wisconsin -- Madison',\n  organizationalUnitName: 'Computer Sciences Department',\n  emailAddress: 'email@sample.com'\n};\n\nconst EXTENSIONS = [{\n  name: 'basicConstraints',\n  cA: true\n}];\n\n\nfunction toNameValue(obj = {}) {\n  return Object.keys(obj).map((key) => ({\n    name: key,\n    value: obj[key]\n  }));\n}\n\nfunction getKeysAndCert(serialNumber = Math.floor(Math.random() * 100000)) {\n\n  let keys = forge.pki.rsa.generateKeyPair(2048);\n  let cert = forge.pki.createCertificate();\n\n  cert.publicKey    = keys.publicKey;\n  cert.serialNumber = String(serialNumber);\n\n  cert.validity.notBefore = new Date();\n  cert.validity.notAfter  = new Date();\n  cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 10);\n\n  return {\n    keys,\n    cert\n  };\n}\n\nfunction generateRootCA(options = {}) {\n\n  let { keys, cert } = getKeysAndCert();\n\n  let subject    = toNameValue({ ...METADATA, ...options.subject });\n  let issuer     = toNameValue({ ...METADATA, ...options.issuer });\n  let extensions = [...EXTENSIONS, ...(options.extensions || [])];\n\n  cert.setSubject(subject);\n  cert.setIssuer(issuer);\n  cert.setExtensions(extensions);\n\n  cert.sign(keys.privateKey, forge.md.sha256.create());\n\n  return {\n    privateKey: forge.pki.privateKeyToPem(keys.privateKey),\n    publicKey: forge.pki.publicKeyToPem(keys.publicKey),\n    certificate: forge.pki.certificateToPem(cert)\n  };\n}\n\nfunction generateCertForHostname(domain, rootCAConfig) {\n\n  // generate a serialNumber for domain\n  let md = forge.md.md5.create();\n\n  md.update(domain);\n\n  let { keys, cert } =  getKeysAndCert(md.digest().toHex());\n\n  let caCert = forge.pki.certificateFromPem(rootCAConfig.cert);\n  let caKey  = forge.pki.privateKeyFromPem(rootCAConfig.key);\n\n  let subject = toNameValue({ ...METADATA, ...{ commonName: domain } });\n\n  cert.setIssuer(caCert.subject.attributes); // issuer from CA\n  cert.setSubject(subject);\n\n  cert.sign(caKey, forge.md.sha256.create());\n\n  return {\n    privateKey: forge.pki.privateKeyToPem(keys.privateKey),\n    publicKey: forge.pki.publicKeyToPem(keys.publicKey),\n    certificate: forge.pki.certificateToPem(cert)\n  };\n}\n\n\nexport {\n  generateRootCA,\n  generateCertForHostname\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/genetator.js\n **/","module.exports = require(\"node-forge\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"node-forge\"\n ** module id = 8\n ** module chunks = 0\n **/"],"sourceRoot":""}